(()=>{"use strict";const t="active",e=document.querySelectorAll(".div-clocks [data-type]"),n=document.querySelector("[data-start-timer]"),o=document.querySelector("[data-progress-bar]"),a=document.querySelector(".activate-pomodoro"),c=document.querySelector("[data-choose]"),s=document.querySelectorAll(".select-time [data-value]"),r=t=>document.querySelector(`[data-timer-type="${t}"]`),l=(document.querySelectorAll("[data-toggle-drop]"),document.querySelectorAll("[data-drop] li")),i=document.querySelectorAll(".alarm-sound-menu li"),d=document.querySelectorAll(".alarm-ticking-menu li"),u=document.querySelector('[data-count="alarm"]'),m=document.querySelector('[data-count="ticking"]'),g=document.querySelector("#volume-alarm"),v=document.querySelector("#volume-ticking");document.querySelectorAll("[data-arrow]");let p=null,S=null,f=null;function L(t,e){t&&(p&&(p.pause(),p.currentTime=0),p=new Audio(t),S=e,p.volume=E(e),p.play())}function y(){return p}function h(){return S}function k(){f&&(f.pause(),f.currentTime=0)}function E(t){const e=document.querySelector(`#volume-${t}`);return e?e.value/100:1}function q(t,e){"alarm"===t?(g.value=e,u.textContent=e):"ticking"===t&&(v.value=e,m.textContent=e)}const x=document.getElementById("task"),T=document.querySelector("textarea"),A=document.querySelector("[data-notes]"),b=document.querySelector("[data-add-tasks]"),D=document.querySelector(".inputTasks"),I=document.querySelector(".menu-clean-tasks"),C=document.querySelector(".menu-clean-tasks [data-remove-all]"),N=document.querySelector(".menu-clean-tasks [data-completed]"),O=(document.querySelector(".activedDivDropDown"),document.querySelector("[data-count]"));let w=[];try{const t=JSON.parse(localStorage.getItem("tasksData"))||[];Array.isArray(t)&&(w=t)}catch(t){console.error("Erro ao ler taskData",t)}function J(t=w){D.innerHTML="",t.forEach(((t,e)=>{const n=R(t.title,t.note,e,t.done);D.appendChild(n)})),M()}function R(t,e,n){const o=function(){const t=document.createElement("span");return t.classList.add("activatedSpan"),t}(),a=function(t){const e=document.createElement("p");return e.classList.add("activatedParagraph"),e.innerText=t,e}(t),c=function(t){const e=document.createElement("div");return e.classList.add("activatedDiv"),e.innerText=t,e}(e),s=function(){const t=document.createElement("button");t.type="button",t.classList.add("activatedEditAndSave");const e=document.createElement("img");return e.src="./images/three-points.svg",e.style.marginTop="2px",t.appendChild(e),t}(),r=function(){const t=document.createElement("div");return t.classList.add("wrapper"),t}(),l=function(t,e){const n=document.createElement("div");return n.classList.add("activatedDivCheckBox"),n.setAttribute("role","checkbox"),n.setAttribute("aria-checked",w[t]?.done),w[t]?.done&&(n.classList.add("alternateStateCheckbox"),e.classList.add("alternateStateParagraph")),n.addEventListener("click",(()=>{n.classList.toggle("alternateStateCheckbox"),e.classList.toggle("alternateStateParagraph"),w[t].done=n.classList.contains("alternateStateCheckbox"),function(){const t=w.every((t=>t.done));w.length>0&&t&&setTimeout((()=>{alert("Parabéns, você concluiu todas as tarefas!"),w.length=0,localStorage.setItem("tasksData",JSON.stringify([])),J()}),500)}(),function(){const t=[...w].sort(((t,e)=>t.done-e.done));w.length=0,w.push(...t),localStorage.setItem("tasksData",JSON.stringify(w)),J()}(),localStorage.setItem("tasksData",JSON.stringify(w))})),n}(n,a);return function(t,e,n,o,a,c){document.addEventListener("click",(t=>{const e=document.querySelector(".activedDivDropDown"),n=t.target;e&&e&&!e.contains(n)&&($(e),P())})),t.addEventListener("click",(s=>{s.stopPropagation(),t.classList.toggle("scale-effect");const r=document.querySelector(".activedDivDropDown");if(r)return void $(r);const l=document.createElement("div");l.classList.add("activedDivDropDown");const i=t.getBoundingClientRect();l.style.position="absolute",l.style.top=`${i.bottom+window.scrollY}px`;const[d,u,m]=function(t,e,n,o,a,c,s){const r=document.createElement("span");r.classList.add("edit"),r.innerText="Editar";const l=document.createElement("div");l.classList.add("divListEdit");const i=document.createElement("button");return i.type="button",i.classList.add("activatedButtonSave"),i.innerText="Salvar",l.appendChild(r),l.addEventListener("click",(()=>{const r=document.createElement("input");r.type="text",r.classList.add("activatedInputTasks"),r.value=w[t].title;const l=document.createElement("input");l.type="text",l.classList.add("activatedInputNote"),l.value=w[t].note,e.replaceWith(r),n.replaceWith(l),s.insertAdjacentElement("beforeend",i),$(a,o),i.addEventListener("click",(()=>{if(w[t].title=r.value,w[t].note=l.value,!w[t].title)return;localStorage.setItem("tasksData",JSON.stringify(w));const e=R(w[t].title,w[t].note,t);c.replaceWith(e),J()}))})),[r,l,i]}(e,n,o,t,l,a,c),[g,v]=function(t,e){const n=document.createElement("span");n.classList.add("remove"),n.innerText="Remover";const o=document.createElement("div");return o.classList.add("divListRemove"),o.appendChild(n),o.addEventListener("click",(()=>{w.splice(t,1),$(e),localStorage.setItem("tasksData",JSON.stringify(w)),J(),M()})),[n,o]}(e,l);l.append(u,v),document.body.appendChild(l)}))}(s,n,a,c,o,r),r.append(l,a,s),o.append(r),e&&o.appendChild(c),o}function $(t,e){t?.remove(),e?.remove()}function P(){document.querySelectorAll(".scale-effect").forEach((t=>{t.classList.remove("scale-effect")}))}function B(e){const n=e.classList.contains(t);e.classList.toggle(t,!n),e.classList.toggle("removeMenu",n)}function M(){O.innerText=w.length}const W=document.querySelector(".modal"),j=document.querySelector(".configs"),Y=document.querySelector(".menu-clean-tasks"),H=document.querySelectorAll("[data-img-close]"),U=document.querySelectorAll("[data-modal], [data-config], [data-menu='button']"),z=document.querySelector(".add-list-tasks"),F=document.querySelector("[data-img-close='tasks']"),G=[W,j,Y],K=e=>{e&&e.preventDefault(),e.stopPropagation();const n=e.target;if(n.hasAttribute("data-modal")&&W.classList.add(t),n.hasAttribute("data-config")){j.classList.add(t),V();const e=window.matchMedia("(max-width: 1440px)");j.style.overflowY=e.matches?"scroll":"hidden"}n.closest("[data-menu]")&&(Y.classList.toggle(t),U[2].classList.toggle("scale-effect"))},Q=e=>{const n=e.target.dataset.imgClose;"modal"===n?W.classList.remove(t):"configs"===n?j.classList.remove(t):(z.classList.remove(t),F.classList.toggle(t))},V=()=>{document.querySelector("[data-close-configs]").addEventListener("click",(()=>{j.classList.remove(t)}),{once:!0})},X=document.querySelectorAll(".container-backgrounds"),Z=document.querySelector("[data-drop-select-bg]"),_=document.querySelector("[data-name]");document.addEventListener("DOMContentLoaded",(()=>{!function(){const e=JSON.parse(localStorage.getItem("dropdownTexts"))||{};function n(){const t=localStorage.getItem("volumes");return t?JSON.parse(t):{alarm:100,ticking:100}}function o(t,e){const o=n();o[t]=e,localStorage.setItem("volumes",JSON.stringify(o))}l.forEach((n=>{n.addEventListener("click",(n=>{const o=n.target,a=o.closest("[data-drop]");if(!a)return;const c=a.getAttribute("data-drop"),s=document.querySelector(`[data-toggle-drop="${c}"]`);if(!s)return;const r=s?.querySelector(".format-innerText");r&&(r.innerText=n.currentTarget.innerText);const l=o.dataset.music,i="alarm-sound"===o.closest("[data-drop]").dataset.drop?"alarm":"ticking";void 0!==l&&""!==l&&L(l,i),document.querySelectorAll("[data-drop]").forEach((e=>{e.classList.contains(t)&&e.classList.remove(t)})),e[c]=r.innerText,localStorage.setItem("dropdownTexts",JSON.stringify(e))})),Object.entries(e).forEach((([t,e])=>{const n=document.querySelector(`[data-toggle-drop="${t}"]`);if(!n)return;const o=n.querySelector(".format-innerText");o&&(o.innerText=e)}))})),document.addEventListener("click",(e=>{let n=!1;document.querySelectorAll("[data-toggle-drop], [data-drop]").forEach((t=>{t.contains(e.target)&&(n=!0)})),n||document.querySelectorAll("[data-drop]").forEach((e=>{e.classList.remove(t)}))})),document.addEventListener("click",(e=>{const n=e.target.closest(".activeDropDownChoose");if(!n)return;const o=n.getAttribute("data-toggle-drop"),a=document.querySelector(`[data-drop="${o}"]`);a&&a.classList.toggle(t)})),g.addEventListener("input",(()=>{const t=Number(g.value);if(u.textContent=g.value,o("alarm",t),"alarm"===h()){const t=y(),e=g.value/100;t&&(t.volume=e)}})),v.addEventListener("input",(()=>{const t=Number(v.value);if(m.textContent=v.value,o("ticking",t),"ticking"===h()){const t=y(),e=v.value/100;t&&(t.volume=e)}}));const a=n();q("alarm",a.alarm),q("ticking",a.ticking)}()})),function(){const e=document.querySelector("[data-img-close='tasks']"),n=document.querySelector(".add-list-tasks");document.querySelector(".tasks").addEventListener("click",(()=>{n.classList.toggle(t),e.classList.toggle(t)}))}(),function(){let l=JSON.parse(localStorage.getItem("timers"))||[];const u={pomodoro:"25:00",short:"05:00",long:"15:00"};let m=null,g=null;i.forEach((t=>{t.addEventListener("click",(t=>{const e=t.target.dataset.music;e&&(m=e)}))})),d.forEach((t=>{t.addEventListener("click",(t=>{const e=t.target.dataset.music;e&&(g=e)}))}));const v={totalSeconds:0,tempoInicial:0,isRunning:!1,interval:null};s.forEach((t=>{t.addEventListener("input",(t=>{const e=t.target.dataset.value.replace("Timer",""),n=t.target.value;if(!n.trim())return;u[e]=`${n.toString().padStart(2,"0")}:00`;const o=r(e);l.push({...u}),localStorage.setItem("timers",JSON.stringify(l)),o&&!o.classList.contains("hidden")&&(o.innerText=u[e])})),function(){const t=l[l.length-1];for(let e in t){const n=r(e);n&&(n.innerText=t[e],u[e]=t[e])}}()}));const S=["pomodoro","short"];let y=0;function h(n){const o="string"==typeof n?n:n.target.dataset.type,a=r(o);if(e.forEach((e=>e.classList.remove(t))),"string"!=typeof n)n.target.classList.add(t);else{const e=(t=>document.querySelector(`[data-type=${t}]`))(o);e&&e.classList.add(t)}if(document.querySelectorAll("[data-timer]").forEach((t=>t.classList.add("hidden"))),a){a.classList.remove("hidden"),a.innerText=u[o];const t=document.body;"pomodoro"===o?t.style.backgroundColor="var(--tomato)":"short"===o?t.style.backgroundColor="var(--backgroundShortBreak)":"long"===o&&(t.style.backgroundColor="var(--backgroundLongBreak)")}}!function(){const e=JSON.parse(localStorage.getItem("state"));e&&(a.classList.toggle(t,e.divChooseActive),c.classList.toggle(t,e.chooseActive))}(),a.addEventListener("click",(function(){a.classList.toggle(t),c.classList.toggle(t);const e={divChooseActive:a.classList.contains(t),chooseActive:c.classList.contains(t)};localStorage.setItem("state",JSON.stringify(e))})),n.addEventListener("click",(function(){const e=document.querySelector("[data-timer]:not(.hidden)"),c=e.dataset.timerType,s=u[c];if(!v.isRunning&&0===v.totalSeconds){const[t,n]=e.innerText.split(":").map(Number);v.totalSeconds=60*t+n,v.tempoInicial=v.totalSeconds}var r;v.isRunning?(v.isRunning=!1,clearInterval(v.interval),n.innerText="COMEÇAR",n.classList.remove(t),k()):(v.isRunning=!0,n.innerText="PAUSAR",n.classList.add(t),n.classList.remove("special-class"),v.totalSeconds>0&&g&&(r=g)&&(f&&(f.pause(),f.currentTime=0),f=new Audio(r),f.loop=!0,p.volume=E("ticking"),f.play()),v.interval=setInterval((()=>{if(v.totalSeconds<=0)return v.isRunning=!1,n.innerText="COMEÇAR",n.classList.remove(t),o.style.width="0",e.innerText=s,clearInterval(v.interval),a.classList.contains(t)&&(y++,y=y>=S.length?0:y,h(S[y]),n.classList.add("special-class")),m&&L(m,"alarm"),void k();const c=(v.tempoInicial-v.totalSeconds)/v.tempoInicial*100;o.style.width=`${c}%`,v.totalSeconds--;const r=Math.floor(v.totalSeconds/60),l=v.totalSeconds%60;e.innerText=`${r.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`}),50))})),e.forEach((t=>t.addEventListener("click",h))),e.length&&e[0].classList.add(t)}(),J(),A.addEventListener("click",(function(){T.classList.toggle(t)})),b.addEventListener("click",(function(){const t=x.value.trim(),e=T.value.trim();if(!t)return;const n={title:t,note:e,done:!1};w.push(n),localStorage.setItem("tasksData",JSON.stringify(w)),J(),x.value="",T.value=""})),C.addEventListener("click",(()=>(w.length=0,localStorage.setItem("tasksData",JSON.stringify(w)),B(I),P(),void J()))),N.addEventListener("click",(()=>function(){const t=w.filter((t=>!t.done));localStorage.setItem("tasksData",JSON.stringify(t)),w.length=0,w.push(...t),B(I),P(),J()}())),document.addEventListener("click",(e=>{const n=e.target;G.forEach(((e,o)=>{n===e&&o<2&&e.classList.remove(t),2!==o||e.contains(n)||(e.classList.remove(t),U[2].classList.remove("scale-effect"))}))})),U.forEach((t=>t.addEventListener("click",K))),H.forEach((t=>t.addEventListener("click",Q))),function(){const e={Pomodoro:()=>_.innerText=" Pomodoro",Short:()=>_.innerText=" Short",Long:()=>_.innerText=" Long"},n=({target:n})=>{Z.classList.add(t);const o=n.dataset.chooseBg;e[o]&&e[o]()};X.forEach((t=>t.addEventListener("click",n)))}()})();