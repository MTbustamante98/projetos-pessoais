(()=>{"use strict";document.querySelector(".modal"),document.querySelector(".configs"),document.querySelector(".menu");const t=document.querySelectorAll("[data-img-close]"),e=document.querySelectorAll("[data-modal], [data-config], [data-menu='button']"),n="active",a=document.querySelectorAll(".div-clocks [data-type]"),o=document.querySelector("[data-start-timer]"),c=document.querySelector("[data-progress-bar]"),s=document.querySelector(".activate-pomodoro"),r=document.querySelector("[data-choose]"),d=document.querySelectorAll(".select-time [data-value]"),l=t=>document.querySelector(`[data-timer-type="${t}"]`);document.getElementById("task"),document.querySelector("textarea"),document.querySelector("[data-notes]"),document.querySelector("[data-add-tasks]");const i=document.querySelector(".inputTasks"),u=document.querySelector(".menu-clean-tasks"),m=(document.querySelector("[data-count]"),document.querySelector(".menu-clean-tasks [data-remove-all]")),g=document.querySelector(".menu-clean-tasks [data-completed]"),p=document.querySelector(".activedDivDropDown"),v=document.querySelector("[data-count]");let S=[];try{const t=JSON.parse(localStorage.getItem("tasksData"))||[];Array.isArray(t)&&(S=t)}catch(t){console.error("Erro ao ler taskData",t)}function L(t=S){i.innerHTML="",t.forEach(((t,e)=>{const n=y(t.title,t.note,e,t.done);i.appendChild(n)})),E()}function y(t,e,n){const a=function(){const t=document.createElement("span");return t.classList.add("activatedSpan"),t}(),o=function(t){const e=document.createElement("p");return e.classList.add("activatedParagraph"),e.innerText=t,e}(t),c=function(t){const e=document.createElement("div");return e.classList.add("activatedDiv"),e.innerText=t,e}(e),s=function(){const t=document.createElement("button");t.type="button",t.classList.add("activatedEditAndSave");const e=document.createElement("img");return e.src="./images/three-points.svg",e.style.marginTop="2px",t.appendChild(e),t}(),r=function(){const t=document.createElement("div");return t.classList.add("wrapper"),t}(),d=function(t,e){const n=document.createElement("div");return n.classList.add("activatedDivCheckBox"),n.setAttribute("role","checkbox"),n.setAttribute("aria-checked",S[t]?.done),S[t]?.done&&(n.classList.add("alternateStateCheckbox"),e.classList.add("alternateStateParagraph")),n.addEventListener("click",(()=>{n.classList.toggle("alternateStateCheckbox"),e.classList.toggle("alternateStateParagraph"),S[t].done=n.classList.contains("alternateStateCheckbox"),allTasksCompleted(),reOrder(),localStorage.setItem("tasksData",JSON.stringify(S))})),n}(n,o);return function(t,e,n,a,o,c){document.addEventListener("click",(t=>{p&&p&&!p.contains(t.target)&&(f(p),document.querySelectorAll(".scale-effect").forEach((t=>{t.classList.remove("scale-effect")})))})),t.addEventListener("click",(s=>{if(s.stopPropagation(),t.classList.toggle("scale-effect"),p)return void f(p);const r=document.createElement("div");r.classList.add("activedDivDropDown");const d=t.getBoundingClientRect();r.style.position="absolute",r.style.top=`${d.bottom+window.scrollY}px`;const[l,i,u]=function(t,e,n,a,o,c,s){const r=document.createElement("span");r.classList.add("edit"),r.innerText="Editar";const d=document.createElement("div");d.classList.add("divListEdit");const l=document.createElement("button");return l.type="button",l.classList.add("activatedButtonSave"),l.innerText="Salvar",d.appendChild(r),d.addEventListener("click",(()=>{const r=document.createElement("input");r.type="text",r.classList.add("activatedInputTasks"),r.value=S[t].title;const d=document.createElement("input");d.type="text",d.classList.add("activatedInputNote"),d.value=S[t].note,e.replaceWith(r),n.replaceWith(d),s.insertAdjacentElement("beforeend",l),f(o,a),l.addEventListener("click",(()=>{if(S[t].title=r.value,S[t].note=d.value,!S[t].title)return;localStorage.setItem("tasksData",JSON.stringify(S));const e=y(S[t].title,S[t].note,t);c.replaceWith(e),L()}))})),[r,d,l]}(e,n,a,t,r,o,c),[m,g]=function(t,e){const n=document.createElement("span");n.classList.add("remove"),n.innerText="Remover";const a=document.createElement("div");return a.classList.add("divListRemove"),a.appendChild(n),a.addEventListener("click",(()=>{S.splice(t,1),f(e),localStorage.setItem("tasksData",JSON.stringify(S)),L(),E()})),[n,a]}(e,r);r.append(i,g),document.body.appendChild(r)}))}(s,n,o,c,a,r),r.append(d,o,s),a.append(r),e&&a.appendChild(c),a}function f(t,e){t?.remove(),e?.remove()}function E(){v.innerText=S.length}!function(){const t=document.querySelector("[data-img-close='tasks']"),e=document.querySelector(".add-list-tasks");document.querySelector(".tasks").addEventListener("click",(()=>{e.classList.toggle(n),t.classList.toggle(n)}))}(),function(){let t=JSON.parse(localStorage.getItem("timers"))||[];const e={pomodoro:"25:00",short:"05:00",long:"15:00"},i={totalSeconds:0,tempoInicial:0,isRunning:!1,interval:null};d.forEach((n=>{n.addEventListener("input",(n=>{const a=n.target.dataset.value.replace("Timer",""),o=n.target.value;if(!o.trim())return;e[a]=`${o.toString().padStart(2,"0")}:00`;const c=l(a);t.push({...e}),localStorage.setItem("timers",JSON.stringify(t)),c&&!c.classList.contains("hidden")&&(c.innerText=e[a])})),function(){const n=t[t.length-1];for(let t in n){const a=l(t);a&&(a.innerText=n[t],e[t]=n[t])}}()}));const u=["pomodoro","short"];let m=0;function g(t){const o="string"==typeof t?t:t.target.dataset.type,c=l(o);if(a.forEach((t=>t.classList.remove(n))),"string"!=typeof t)t.target.classList.add(n);else{const t=(t=>document.querySelector(`[data-type=${t}]`))(o);t&&t.classList.add(n)}if(document.querySelectorAll("[data-timer]").forEach((t=>t.classList.add("hidden"))),c){c.classList.remove("hidden"),c.innerText=e[o];const t=document.body;"pomodoro"===o?t.style.backgroundColor="var(--tomato)":"short"===o?t.style.backgroundColor="var(--backgroundShortBreak)":"long"===o&&(t.style.backgroundColor="var(--backgroundLongBreak)")}}!function(){const t=JSON.parse(localStorage.getItem("state"));t&&(s.classList.toggle(n,t.divChooseActive),r.classList.toggle(n,t.chooseActive))}(),s.addEventListener("click",(function(){s.classList.toggle(n),r.classList.toggle(n);const t={divChooseActive:s.classList.contains(n),chooseActive:r.classList.contains(n)};localStorage.setItem("state",JSON.stringify(t))})),o.addEventListener("click",(function(){const t=document.querySelector("[data-timer]:not(.hidden)"),a=t.dataset.timerType,r=e[a];if(!i.isRunning&&0===i.totalSeconds){const[e,n]=t.innerText.split(":").map(Number);i.totalSeconds=60*e+n,i.tempoInicial=i.totalSeconds}i.isRunning?(i.isRunning=!1,clearInterval(i.interval),o.innerText="COMEÇAR",o.classList.remove(n)):(i.isRunning=!0,o.innerText="PAUSAR",o.classList.add(n),o.classList.remove("special-class"),i.interval=setInterval((()=>{if(i.totalSeconds<=0)return i.isRunning=!1,o.innerText="COMEÇAR",c.style.width="0",t.innerText=r,clearInterval(i.interval),void(s.classList.contains(n)&&(m++,m=m>=u.length?0:m,g(u[m]),o.classList.add("special-class")));const e=(i.tempoInicial-i.totalSeconds)/i.tempoInicial*100;c.style.width=`${e}%`,i.totalSeconds--;const a=Math.floor(i.totalSeconds/60),d=i.totalSeconds%60;t.innerText=`${a.toString().padStart(2,"0")}:${d.toString().padStart(2,"0")}`}),50))})),a.forEach((t=>t.addEventListener("click",g))),a.length&&a[0].classList.add(n)}(),function(){const t=document.querySelectorAll("[data-toggle-drop]"),e=document.querySelectorAll("[data-drop] li"),a=t=>{const e=t.target.getAttribute("data-toggle-drop"),a=document.querySelector(`[data-drop="${e}"]`);a&&a.classList.toggle(n)};e.forEach((t=>{t.addEventListener("click",(t=>{const e=t.target.closest("[data-drop]");if(!e)return;const a=e.getAttribute("data-drop"),o=document.querySelector(`[data-toggle-drop="${a}"]`);if(!o)return;const c=o?.querySelector(".format-innerText");c&&(c.innerText=t.target.innerText),document.querySelectorAll("[data-drop]").forEach((t=>{t.classList.contains(n)&&t.classList.remove(n)}))}))})),document.addEventListener("click",(t=>{let e=!1;document.querySelectorAll("[data-toggle-drop], [data-drop]").forEach((n=>{n.contains(t.target)&&(e=!0)})),e||document.querySelectorAll("[data-drop]").forEach((t=>{t.classList.remove(n)}))})),t.forEach((t=>{t.addEventListener("click",a)}))}(),L(),addNotes.addEventListener("click",addTextArea),buttonAddTasks.addEventListener("click",addTasksAndNotes),m.addEventListener("click",(()=>handleRemoveAllTasks(u))),g.addEventListener("click",(()=>removeAllCompletedTasks(u))),document.addEventListener("click",(()=>closeModal)),e.forEach((t=>t.addEventListener("click",openModal))),t.forEach((t=>t.addEventListener("click",imgCloseModalAndConfigs)))})();